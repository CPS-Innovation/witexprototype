<!-- "govuk-frontend": "^4.7.0", -->
{% extends "layoutCPS-NEW-CASEFILE.html" %}
{% block header %}
{% include "../includes/banner-V7.html" %}
{% endblock %}
{% block beforeContent %}
{% endblock %}
{% block content %}
<script type="module" src="/public/javascripts/moj-frontend-41ac88f676.min.js"></script>
<script src="/public/javascripts/sorttable.js"></script>
<script src="/public/javascripts/filter-toggle-button.js"></script>
<!-- <link href="/public/stylesheets/filtering.css" media="screen" rel="stylesheet" type="text/css" /> -->
<!-- remove if you get rid of the gov width container -->
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" integrity="sha512-uto9mlQzrs59VwILcLiRYeLKPPbS/bT71da/OEBYEwcdNUk8jYIy+D176RYoop1Da+f9mvkYrmj5MCLZWEtQuA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> -->
<style>
    .cpsTagBlack {
        background-color:black;color:white; width:80%;font-weight:700 !important;text-align: center;
    }

.cpsTagRed {
        background-color:#d4351c ;color:white; width:80%;font-weight:700 !important;text-align: center;
    }

.cpsTagYellow {
        background-color:#ffdd00 ;color:black; width:80%;font-weight:700 !important;text-align: center;
    }

.cpsTagUnkown {
        background-color:white;color:black; width:80%;font-weight:700 !important;text-align: center; border: 3px solid #d4351c  ;
    }


.taskCountBar {margin-left:100px
}

.taskOverViewContent {
    display:flex;margin-left:auto; width:80%
}

.taskOverViewContentPanel {
    display:flex;margin-left:auto; 
}

.taskCountItems {
    border: 2px solid black; display:flex;   align-items: center;
  justify-content: center;
  height:50px;
  margin-right:15px;
}

.taskcCountItemNumber {
    font-size:19px; font-weight:700; margin-left:auto; margin-bottom:0
}


.fa-triangle-exclamation {
    color:#d4351c; 
}

 .fa-chevron-down, .fa-triangle-exclamation {
    font-size:19px
}

             
.govuk-tag--red {

    background: #f4cdc6;
}

.panelTagRed {
    min-width:200px;
}

.govuk-tag {
      font-size:19px !important;
}

/*pulls the content next to the checkboxes closer on the main panel*/
.govuk-checkboxes__item {
        margin-right:-30px;
    }

.expandable-panel {
    display: none;
}


.cpsAdminMenuWrapper {
 max-width:1400px;
    }

.mb15 {
    margin-bottom: 15px;
}

.MT-15 {
    margin-top:-7px;
}



.addRightLine {position:relative}
.addRightLine:after {
             content: '';
            position: absolute;
            right: -10%;
            top: 20%; /* (100% - 75%) / 2 to center the line vertically */
            width: 1px; /* Adjust width of the line */
            height: 75%; /* 75% of the height of the parent box */
            background-color: #505a5f   ; /* Adjust color as needed */
}

    .makeBannerMiddle {
    display: none;
}

.caseReviewHeader {
    display: none
}

.govuk-tabs__panel {
 padding-left:0 !important;
 padding-right:0 !important;
 border:0 !important;
}

.govuk-table__cell, .govuk-table__header {
    font-size: 19px;
}

.bold {font-weight: 700}

nav {padding:0 !important}

.govuk-checkboxes__label::before {
  background-color: #ffffff; /* force white background */
}

.moj-action-bar__filter button {
    margin-bottom:20px !important;
}


</style>
<script>

       $(document).ready(function() {
        $('#global-navigation').show();
         $('.my-cases').attr('aria-current', 'page');
        $('.sub-case').attr('aria-current', 'page');

});

    </script>

<div style=" display: flex; align-items: center;">
    <div class="govuk-grid-column-two-thirds-quarters" style="display: flex; width: 100%;">
        <div class="taskOverViewContent" style="justify-content: flex-end; display: flex; align-items: center;">
            <p style="margin-left:15px; margin-bottom: 30px;">
                <a href="" style="display: inline-block; ">Guidance</a>
            </p>
            <p style="margin-left:15px; margin-bottom: 30px;">
                <a href="" style="display: inline-block;">Further housekeeping</a>
            </p>
            <button type="submit" class="govuk-button" style="margin-left:15px;">
                Complete triage
            </button>
        </div>
    </div>
</div>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        <div class="govuk-tabs" data-module="govuk-tabs" style="">
            <h2 class="govuk-tabs__title">
                Contents
            </h2>
            <ul class="govuk-tabs__list">
                <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
                    <a class="govuk-tabs__tab" href="#past-day">
                        PCD request
                    </a>
                </li>
                <li class="govuk-tabs__list-item">
                    <a class="govuk-tabs__tab" href="#past-week">
                        Materials (20)
                    </a>
                </li>
                <li class="govuk-tabs__list-item">
                    <a class="govuk-tabs__tab" href="#past-month" style="min-width:185px; text-overflow: unset">
                        Communications (<span data-comm-total></span>)
                    </a>
                </li>
            </ul>
            <div class="govuk-tabs__panel" id="past-day">
            </div>
            <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="past-week">
                <div class="">
                    <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" style="float:right">
                        Add material</button>
                </div>
                <div class="" style="padding-left:0; padding-right:0; display:flex; align-items: center;">
                    <p> Showing <strong>15</strong> materials out of <strong>20</strong></p>
                </div>
                <table class="govuk-table">
                    <thead class="govuk-table__head">
                        <tr class="govuk-table__row">
                            <th scope="col" class="govuk-table__header">
                                <!-- <div class="govuk-form-group"> -->
                                <!-- <fieldset class="govuk-fieldset"> -->
                                <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                        <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                        </label>
                                    </div>
                                </div>
                                <!-- </fieldset> -->
                                <!-- </div> -->
                            </th>
                            <th scope="col" class="govuk-table__header">Material</th>
                            <th scope="col" class="govuk-table__header">Type</th>
                            <th scope="col" class="govuk-table__header">Category</th>
                            <th scope="col" class="govuk-table__header">Status</th>
                            <th scope="col" class="govuk-table__header">From</th>
                            <th scope="col" class="govuk-table__header ">Date</th>
                            <th scope="col" class="govuk-table__header"></th>
                        </tr>
                    </thead>
                    <tbody class="govuk-table__body">
                        <tr class="govuk-table__row">
                            <td class="govuk-table__cell">
                                <!-- <div class="govuk-form-group"> -->
                                <!-- <fieldset class="govuk-fieldset"> -->
                                <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                    <div class="govuk-checkboxes__item">
                                        <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                        <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                        </label>
                                    </div>
                                </div>
                                <!-- </fieldset> -->
                                <!-- </div> -->
                            </td>
                            <td class="govuk-table__cell "><strong class="govuk-tag govuk-tag--blue" style="margin-right:10px">New</strong>MG3 (1 suspect)</td>
                            <td class="govuk-table__cell"> MG3</td>
                            <td class="govuk-table__cell ">MG Form</td>
                            <td class="govuk-table__cell"><strong class="govuk-tag govuk-tag--light-blue" style="">Used</strong></td>
                            <td class="govuk-table__cell">Police</td>
                            <td class="govuk-table__cell">13/01/2025</td>
                            <td class="govuk-table__cell toggle-panel"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                        </tr>
                        {% include "../includes/panels/panel1.html" %}
                    </tbody>
                </table>
            </div>
            <!-- ------------------------- HERE IS THE COMMS TAB --------------------------------------------------------------------------- -->
            <div class="govuk-tabs__panel govuk-tabs__panel--hidden" id="past-month">
                <!-- HERE IS THE COMMS TAB -->
                <!--   <div class="govuk-grid-row">
                    <div class="govuk-grid-column-one-quarter"> -->
                <div class="moj-filter-layout">
                    <div class="moj-filter-layout__filter">
                        <div class="moj-filter" style="box-shadow:none; padding:20px; background-color:#f3f2f1;">
                            <div class="moj-filter__header" style="background-color:#f3f2f1; padding-left:0; padding-top:0">
                                <div class="moj-filter__header-title">
                                    <h2 class="govuk-heading-m" style="margin-top:-22px">Filters</h2>
                                </div>
                                <div class="moj-filter__heading-action">
                                    <p><a id="clearFiltersLink" class="govuk-link govuk-link--no-visited-state" href="#">Clear filters</a></p>
                                </div>
                            </div>
                            <div class="moj-filter__content">
                                <!--  -->
                                <div class="moj-filter__options" style="box-shadow:none;padding:0px">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-label--s" for="keywords">
                                            Subject keywords
                                        </label>
                                        <input class="govuk-input" id="keywords" name="keywords" type="text">
                                    </div>
                                    <div class="govuk-form-group">
                                        <fieldset class="govuk-fieldset">
                                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                                                New communications
                                            </legend>
                                            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status" name="newComms" type="checkbox" value="1">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status">
                                                        Show only new <br />communications (unread)
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                    <div class="govuk-form-group">
                                        <fieldset class="govuk-fieldset">
                                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                                                In/Out
                                            </legend>
                                            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="type" name="In/Out" type="checkbox" value="1">
                                                    <label class="govuk-label govuk-checkboxes__label" for="type">
                                                        Incoming
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="type-2" name="In/Out" type="checkbox" value="2">
                                                    <label class="govuk-label govuk-checkboxes__label" for="type-2">
                                                        Outgoing
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                    <div class="govuk-form-group">
                                        <fieldset class="govuk-fieldset">
                                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                                                Category
                                            </legend>
                                            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status" name="status-11" type="checkbox" value="Bundle">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-11">
                                                        Bundle
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status-22" name="status" type="checkbox" value="22">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-22">
                                                        Document
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status-33" name="status" type="checkbox" value="33">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-33">
                                                        Email
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status-44" name="status" type="checkbox" value="44">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-44">
                                                        Item
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status-55" name="status" type="checkbox" value="55">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-55">
                                                        Meeting
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="status-66" name="status" type="checkbox" value="66">
                                                    <label class="govuk-label govuk-checkboxes__label" for="status-66">
                                                        Telephone call
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </div>
                                    <div class="govuk-form-group">
                                        <fieldset class="govuk-fieldset">
                                            <legend class="govuk-fieldset__legend govuk-fieldset__legend--s">
                                                Comms with
                                            </legend>
                                            <div class="govuk-checkboxes govuk-checkboxes--small" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-111" name="commsWith" type="checkbox" value="111">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-111">
                                                        Counsel
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-222" name="commsWith" type="checkbox" value="222">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-222">
                                                        Court
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-333" name="commsWith" type="checkbox" value="333">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-333">
                                                        DCS
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-444" name="commsWith" type="checkbox" value="444">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-444">
                                                        Defence
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-555" name="commsWith" type="checkbox" value="555">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-555">
                                                        Police
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-666" name="commsWith" type="checkbox" value="666">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-666">
                                                        WCU
                                                    </label>
                                                </div>
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="commsWith-777" name="commsWith" type="checkbox" value="777">
                                                    <label class="govuk-label govuk-checkboxes__label" for="commsWith-777">
                                                        Other
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                        <button id="applyFiltersBtn" type="submit" class="govuk-button" data-module="govuk-button" style="margin-top:25px">
                                            Apply filters</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="moj-filter-layout__content">
                        <!--          </div>
                    </div> -->
                        <!-- <div class="govuk-grid-column-full" id="three-quarters"> -->
                        <div class="moj-scrollable-pane">
                            <div style="">
                                <!-- Label sits outside, behaves naturally -->
                                <!-- <label class="govuk-label govuk-label--s" for="searchURNModal">Search communications</label> -->
                                <!-- Flex container: input + search icon + green button aligned -->
                                <div style="display: flex; align-items: center; gap: 15px; margin-top: 5px;">
                                    <!-- Input + search icon -->
                                    <div style="display: none; align-items: center; height: 40px;">
                                        <input class="govuk-input" id="searchURNModal" name="searchURNModal" type="text" placeholder="" style="width:350px" />
                                        <button class="search searchModal modalButton" type="button" id="runSearch" style="background-position: -2% 50%"></button>
                                    </div>
                                    <!-- Auto reclassify button -->
                                    <!--                                     <button type="submit" class="govuk-button" data-module="govuk-button" style="margin: 0;">
                                        Auto Reclassify UM
                                    </button>
                                    <button type="submit" class="govuk-button govuk-button--secondary" disabled aria-disabled="true" data-module="govuk-button" style="margin: 0;">
                                        Reclasify to Unused
                                    </button> -->
                                </div>
                            </div>
                            <div class="moj-action-bar__filter"></div>

                            <div class="app-c-filter-summary" id="activeFiltersArea" style="display:none ; border-bottom: 1px solid #b1b4b6; margin-bottom:20px">
                                <h3 class="app-c-filter-summary__heading" style="margin-top:0; font-weight:700">Active filters</h3>
                                <div style="display:flex">
                                    <ul class="app-c-filter-summary__remove-filters" data-active-filters>
                                        <!-- Dynamic filter lozenges will be inserted here -->
                                    </ul>
                                    <p style="margin:8px 15px"> <a href="javascript:void(0)" class="clear-filters govuk-link govuk-link--no-visited-state">Clear all filters</a></p>
                                </div>
                                <!--   <div style="display:inline-block;">
                                                    <p style="margin-bottom:0"> <a href="javascript:void(0)" class="clear-filters govuk-link govuk-link--no-visited-state">Clear all filters</a></p>
                                                </div> -->
                            </div>


                         <div class="govuk-grid-column-full" style="padding-left:0; padding-right:0; display:flex; align-items: center;">
                            <p > Showing <strong data-comm-shown></strong> communications out of <strong data-comm-total></strong></p>
                            </div>
                            <div style="margin-bottom:20px; ">
                                <button type="submit" class="govuk-button govuk-button--secondary" disabled aria-disabled="true" data-module="govuk-button" style="margin: 0;">
                                    Reclassify to Unused
                                </button>
                                <button type="submit" class="govuk-button govuk-button--secondary" data-module="govuk-button" style="margin-left:10px; margin-bottom:0px">
                                    Auto Reclassify UM
                                </button>
                            </div>
                            <!-- <div class="moj-scrollable-pane"> -->
                            <table class="govuk-table" data-module="moj-sortable-table">
                                <thead class="govuk-table__head">
                                    <tr class="govuk-table__row">
                                        <th scope="col" class="govuk-table__header">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </th>
                                        <th scope="col" class="govuk-table__header" aria-sort="ascending">Subject</th>
                                        <th scope="col" class="govuk-table__header" aria-sort="none">In/Out</th>
                                        <th scope="col" class="govuk-table__header" aria-sort="none">Comms with</th>
                                        <th scope="col" class="govuk-table__header" aria-sort="none">Comms type</th>
                                        <th scope="col" class="govuk-table__header" aria-sort="none">Type</th>
                                        <th scope="col" class="govuk-table__header " aria-sort="none">Date</th>
                                        <th scope="col" class="govuk-table__header"></th>
                                    </tr>
                                </thead>
                                <tbody class="govuk-table__body">
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <strong class="govuk-tag govuk-tag--blue" style="margin-right:10px; flex-shrink:0;">New</strong>
                                                <span>Police update</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell"> Incoming</td>
                                        <td class="govuk-table__cell ">Police</td>
                                        <td class="govuk-table__cell">Bundle</td>
                                        <td class="govuk-table__cell">Other communication</td>
                                        <td class="govuk-table__cell">01/02/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <strong class="govuk-tag govuk-tag--blue" style="margin-right:10px; flex-shrink:0;">New</strong>
                                                <span>Official statement on trial</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell"> Outgoing</td>
                                        <td class="govuk-table__cell ">Counsel</td>
                                        <td class="govuk-table__cell">Document</td>
                                        <td class="govuk-table__cell">Asset recovery</td>
                                        <td class="govuk-table__cell">21/03/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <strong class="govuk-tag govuk-tag--blue" style="margin-right:10px; flex-shrink:0;">New</strong>
                                                <span>Legal matter</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell"> Outgoing</td>
                                        <td class="govuk-table__cell ">Counsel</td>
                                        <td class="govuk-table__cell">Comms Type</td>
                                        <td class="govuk-table__cell">Counsel case acknowedgement</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Official court notice</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">Police</td>
                                        <td class="govuk-table__cell">Bundle</td>
                                        <td class="govuk-table__cell">Other communication</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>New developments in Maggie Simpson's case</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Outgoing</td>
                                        <td class="govuk-table__cell ">Police</td>
                                        <td class="govuk-table__cell">Telephone call</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Maggie Simpson - Court Case update</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Outgoing</td>
                                        <td class="govuk-table__cell ">Defence</td>
                                        <td class="govuk-table__cell">Email</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Meeting with WCU</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Outgoing</td>
                                        <td class="govuk-table__cell ">WCU</td>
                                        <td class="govuk-table__cell">Meeting</td>
                                        <td class="govuk-table__cell">Other communications</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>JDU update Maggie Simpson</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">Court</td>
                                        <td class="govuk-table__cell">Item</td>
                                        <td class="govuk-table__cell">Physical media</td>
                                        <td class="govuk-table__cell">01/02/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>New developments on 0723 Case</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Outgoing</td>
                                        <td class="govuk-table__cell ">Court</td>
                                        <td class="govuk-table__cell">Document</td>
                                        <td class="govuk-table__cell">Other communication</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Legal proceedings update</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">Counsel</td>
                                        <td class="govuk-table__cell">Telephone call</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">21/03/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Case under review</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Outgoing</td>
                                        <td class="govuk-table__cell ">Police</td>
                                        <td class="govuk-table__cell">Email</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Court Summons</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">DCS</td>
                                        <td class="govuk-table__cell">Email</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">13/01/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Justice department update</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">DCS</td>
                                        <td class="govuk-table__cell">Comms Type</td>
                                        <td class="govuk-table__cell">Other communication</td>
                                        <td class="govuk-table__cell">21/03/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Update 6123754</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">WCU</td>
                                        <td class="govuk-table__cell">Meeting</td>
                                        <td class="govuk-table__cell">Other communication</td>
                                        <td class="govuk-table__cell">01/02/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                    <tr class="govuk-table__row">
                                        <td class="govuk-table__cell">
                                            <!-- <div class="govuk-form-group"> -->
                                            <!-- <fieldset class="govuk-fieldset"> -->
                                            <div class="govuk-checkboxes govuk-checkboxes--small MT-15" data-module="govuk-checkboxes">
                                                <div class="govuk-checkboxes__item">
                                                    <input class="govuk-checkboxes__input" id="organisation" name="organisation" type="checkbox" value="hmrc">
                                                    <label class="govuk-label govuk-checkboxes__label" for="organisation">
                                                    </label>
                                                </div>
                                            </div>
                                            <!-- </fieldset> -->
                                            <!-- </div> -->
                                        </td>
                                        <td class="govuk-table__cell subject-cell">
                                            <div style="display: flex; align-items: flex-start;">
                                                <span>Important legal update</span>
                                            </div>
                                        </td>
                                        <td class="govuk-table__cell">Incoming</td>
                                        <td class="govuk-table__cell ">Counsel</td>
                                        <td class="govuk-table__cell">Email</td>
                                        <td class="govuk-table__cell">Correspondence</td>
                                        <td class="govuk-table__cell">01/02/2025</td>
                                        <td class="govuk-table__cell toggle-panel" style="min-width:85px"><span class="looks-like-a-link-underline-v2">Actions<i class="fa-solid fa-chevron-down" style="padding-left:5px; font-size:14px; "></i></span></td>
                                    </tr>
                                </tbody>
                            </table>
                            <p id="no-results-message" class="govuk-body" style="display: none;">
                                No results found
                            </p>
                            <!-- </div> -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
     <script type="text/javascript">
  MOJFrontend.initAll();
</script>
<script type="module">
  // Store the existing MOJ filter toggle instance without altering its behavior.
  const mojFilterToggle = new MOJFrontend.FilterToggleButton({
    bigModeMediaQuery: '(min-width: 48.063em)',
    startHidden: true,
    toggleButton: {
      container: document.querySelector('.moj-action-bar__filter'),
      showText: 'Show filter',
      hideText: 'Hide filter',
      classes: 'govuk-button--secondary'
    },
    closeButton: {
      container: document.querySelector('.moj-filter__header-action'),
      text: 'Close'
    },
    filter: {
      container: document.querySelector('.moj-filter')
    }
  });
</script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const shownDisplay = document.querySelector('[data-comm-shown]');
  const applyFiltersBtn = document.getElementById('applyFiltersBtn');
  const activeFiltersArea = document.getElementById('activeFiltersArea');
  const filters = {
    keywords: () => document.getElementById('keywords').value.trim().toLowerCase(),
    newComms: () => document.querySelector('input[name="newComms"]:checked') !== null,
    type: () => [...document.querySelectorAll('input[name="In/Out"]:checked')].map(el => el.nextElementSibling.innerText.trim().toLowerCase()),
    status: () => [...document.querySelectorAll('input[name^="status"]:checked')].map(el => el.nextElementSibling.innerText.trim().toLowerCase()),
    commsWith: () => [...document.querySelectorAll('input[name="commsWith"]:checked')].map(el => el.nextElementSibling.innerText.trim().toLowerCase())
  };

  const rows = [...document.querySelectorAll('#past-month tbody tr.govuk-table__row')];
  const activeFilterList = document.querySelector('[data-active-filters]');
  const noResults = document.getElementById('no-results-message');
  const total = rows.length;

  // Update totals
  document.querySelectorAll('[data-comm-total]').forEach(el => el.textContent = total);
  document.querySelectorAll('[data-comm-shown]').forEach(el => el.textContent = total);

  function applyFilters() {
    const active = {
      keyword: filters.keywords(),
      newComms: filters.newComms(),
      type: filters.type(),
      status: filters.status(),
      commsWith: filters.commsWith()
    };

    let visibleCount = 0;
    rows.forEach(row => {
      const subject = row.querySelector('.subject-cell')?.innerText.toLowerCase() || '';
      const type = row.children[2].innerText.toLowerCase().trim();
      const commsWith = row.children[3].innerText.toLowerCase().trim();
      const category = row.children[4].innerText.toLowerCase().trim();
      const isNew = row.querySelector('.govuk-tag--blue') !== null;

      const matchKeyword = !active.keyword || subject.includes(active.keyword);
      const matchNewComms = !active.newComms || isNew;
      const matchType = active.type.length === 0 || active.type.includes(type);
      const matchStatus = active.status.length === 0 || active.status.includes(category);
      const matchCommsWith = active.commsWith.length === 0 || active.commsWith.includes(commsWith);

      const matches = matchKeyword && matchNewComms && matchType && matchStatus && matchCommsWith;
      row.style.display = matches ? '' : 'none';
      if (matches) visibleCount++;
    });

    shownDisplay.textContent = visibleCount;
    noResults.style.display = visibleCount === 0 ? 'block' : 'none';
    updateLozenges(active);
  }

  function updateLozenges(active) {
    activeFilterList.innerHTML = '';

    const addFilter = (filterType, value) => {
      const li = document.createElement('li');
      li.innerHTML = `
        <a class="app-c-filter-summary__remove-filter" href="javascript:void(0)" data-filter="${filterType}" data-filter-value="${value}">
          <span class="app-c-filter-summary__remove-filter-text">
            <span class="govuk-visually-hidden">Remove filter</span>
            ${filterType.charAt(0).toUpperCase() + filterType.slice(1)}: ${value}
          </span>
        </a>
      `;
      activeFilterList.appendChild(li);
    };

    if (active.keyword) addFilter('Keyword', active.keyword);
    if (active.newComms) addFilter('New communications', 'Unread');
    active.type.forEach(val => addFilter('In/Out', val));
    active.status.forEach(val => addFilter('Category', val));
    active.commsWith.forEach(val => addFilter('Comms with', val));

    activeFiltersArea.style.display = activeFilterList.children.length ? 'block' : 'none';

    document.querySelectorAll('.app-c-filter-summary__remove-filter').forEach(link => {
      link.addEventListener('click', () => {
        const filterType = link.getAttribute('data-filter');
        const filterValue = link.getAttribute('data-filter-value');
        removeFilter(filterType, filterValue);
        applyFilters();
      });
    });
  }

  function removeFilter(filterType, filterValue) {
    switch (filterType) {
      case 'Keyword':
        document.getElementById('keywords').value = '';
        break;
      case 'New communications':
        document.querySelector('input[name="newComms"]').checked = false;
        break;
      case 'In/Out':
        document.querySelectorAll('input[name="In/Out"]').forEach(el => {
          if (el.nextElementSibling.innerText.trim().toLowerCase() === filterValue.toLowerCase()) {
            el.checked = false;
          }
        });
        break;
      case 'Category':
        document.querySelectorAll('input[name^="status"]').forEach(el => {
          if (el.nextElementSibling.innerText.trim().toLowerCase() === filterValue.toLowerCase()) {
            el.checked = false;
          }
        });
        break;
      case 'Comms with':
        document.querySelectorAll('input[name="commsWith"]').forEach(el => {
          if (el.nextElementSibling.innerText.trim().toLowerCase() === filterValue.toLowerCase()) {
            el.checked = false;
          }
        });
        break;
    }
  }

  function clearFilters() {
    document.getElementById('keywords').value = '';
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    applyFilters();
  }

  applyFiltersBtn.addEventListener('click', e => {
    e.preventDefault();
    applyFilters();
    const toggleBtn = document.querySelector('.moj-action-bar__filter button');
    if (toggleBtn && toggleBtn.textContent.trim() === 'Hide filter') {
      toggleBtn.click();
    }
  });

  // Attach clear filters handler to both clear filters buttons/links.
  document.querySelectorAll('.clear-filters, #clearFiltersLink').forEach(clearLink => {
    clearLink.addEventListener('click', e => {
      e.preventDefault();
      clearFilters();
    });
  });

  clearFilters();
});
</script>
{% endblock %}